<?xml version="1.0" encoding="utf-8" ?>
<ContentPage 
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="StockWise.Client.Paginas.Usuarios.ListaUsuariosPage"
    Title="GestiÃ³n de usuarios"
    BackgroundColor="#0A0F1C">

    <!-- ============================================================= -->
    <!-- GRID PRINCIPAL â†’ Igual que en ProductosPage -->
    <!-- ============================================================= -->
    <Grid RowDefinitions="Auto, Auto, *"
          Padding="0">

        <!-- ============================================================= -->
        <!-- ðŸ”¥ FILA 0: HEADER -->
        <!-- ============================================================= -->
        <Grid Grid.Row="0"
              ColumnDefinitions="Auto, *"
              Padding="15,20">

            <!-- BotÃ³n hamburguesa -->
            <Frame Padding="5"
                   BackgroundColor="Transparent"
                   HasShadow="False"
                   HorizontalOptions="Start"
                   VerticalOptions="Center">

                <Label Text="â˜°"
                       FontSize="32"
                       TextColor="White">
                    <Label.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnMenuToggleClicked"/>
                    </Label.GestureRecognizers>
                </Label>

            </Frame>

            <Label Grid.Column="1"
                   Text="QRStock - Usuarios"
                   HorizontalOptions="Center"
                   VerticalOptions="Center"
                   FontSize="22"
                   FontAttributes="Bold"
                   TextColor="#4EE1A0"/>
        </Grid>


        <!-- ============================================================= -->
        <!-- ðŸ”¥ FILA 1: MENÃš DESPLEGABLE (IGUAL QUE PRODUCTOS) -->
        <!-- ============================================================= -->
        <StackLayout x:Name="MenuContainer"
             Grid.Row="1"
             Padding="10"
             BackgroundColor="#121A2A"
             WidthRequest="200"
             Opacity="0.92"
             IsVisible="False"
             HorizontalOptions="Start"
             VerticalOptions="Start"
             Margin="15,10,0,0"
             Spacing="10">

            <Button Text="ðŸ‘¤ Mi perfil"
            BackgroundColor="#1E2A44"
            TextColor="White"
            CornerRadius="10"
            HeightRequest="40"
            WidthRequest="170"
            HorizontalOptions="Start"
            Clicked="OnPerfilClicked"/>

            <Button Text="ðŸ“¦ Productos"
            BackgroundColor="#1E2A44"
            TextColor="White"
            CornerRadius="10"
            HeightRequest="40"
            WidthRequest="170"
            HorizontalOptions="Start"
            x:Name="BtnProductos"
            Clicked="OnProductosClicked"/>

   
                <Button Text="ðŸ¢ Editar empresa"
                BackgroundColor="#1E2A44"
                TextColor="White"
                CornerRadius="10"
                HeightRequest="40"
                WidthRequest="170"
                HorizontalOptions="Start"
                x:Name="BtnEditarEmpresa"
                Clicked="OnEditarEmpresaClicked"/>
           

            <Button Text="ðŸ“œ Movimientos"
            BackgroundColor="#1E2A44"
            TextColor="White"
            CornerRadius="10"
            HeightRequest="40"
            WidthRequest="170"
            HorizontalOptions="Start"
            Clicked="OnMovimientosClicked"/>

            <Button Text="ðŸšª Cerrar sesiÃ³n"
            BackgroundColor="#c62828"
            TextColor="White"
            CornerRadius="10"
            HeightRequest="40"
            WidthRequest="170"
            HorizontalOptions="Start"
            Clicked="OnLogoutClicked"/>

        </StackLayout>




        <!-- ============================================================= -->
        <!-- ðŸ”¥ FILA 2: CONTENIDO PRINCIPAL -->
        <!-- ============================================================= -->
        <ScrollView Grid.Row="2">
            <VerticalStackLayout Padding="20" Spacing="15">

                <!-- BotÃ³n crear usuario -->
                <Button Text="+ Crear usuario"
                        BackgroundColor="#4EE1A0"
                        TextColor="#0A0F1C"
                        CornerRadius="12"
                        HeightRequest="45"
                        x:Name="BtnCrearUsuario"
                        Clicked="OnCrearUsuarioClicked"/>

                <!-- CABECERA TABLA -->
                <Frame BackgroundColor="#121A2A"
                       CornerRadius="10"
                       Padding="5"
                       HasShadow="False">

                    <Grid ColumnDefinitions="3*,3*,2*,Auto,Auto">
                        <Label Text="Usuario"
                               TextColor="#4EE1A0"
                               FontAttributes="Bold"/>

                        <Label Grid.Column="1"
                               Text="Email"
                               TextColor="#4EE1A0"
                               FontAttributes="Bold"/>

                        <Label Grid.Column="2"
                               Text="Rol"
                               TextColor="#4EE1A0"
                               FontAttributes="Bold"/>

                        <Label Grid.Column="3"/>
                        <Label Grid.Column="4"/>
                    </Grid>
                </Frame>

                <!-- LISTA DE USUARIOS -->
                <CollectionView x:Name="UsuariosList"
                                SelectionMode="None">

                    <CollectionView.ItemTemplate>
                        <DataTemplate>

                            <Frame BackgroundColor="#121A2A"
                                   CornerRadius="10"
                                   Padding="10"
                                   Margin="0,5"
                                   HasShadow="False">

                                <Grid ColumnDefinitions="3*,3*,2*,Auto,Auto,Auto"
                                      Padding="15,0">

                                    <Label Text="{Binding NombreUsuario}"
                                           TextColor="White"/>

                                    <Label Grid.Column="1"
                                           Text="{Binding Email}"
                                           TextColor="#7DA0C0"/>

                                    <Label Grid.Column="2"
                                           Text="{Binding Rol}"
                                           TextColor="#4EE1A0"
                                           Padding="30,0"/>

                                    <Button Grid.Column="3"
                                            Text="âœï¸"
                                            FontSize="18"
                                            BackgroundColor="Transparent"
                                            TextColor="#4EE1A0"
                                            Clicked="OnEditarClicked"
                                            BindingContext="{Binding}"/>

                                    <Button Grid.Column="4"
                                            Text="ðŸ”"
                                            FontSize="18"
                                            BackgroundColor="Transparent"
                                            TextColor="#FFB74D"
                                            Clicked="OnResetPasswordClicked"
                                            BindingContext="{Binding}"/>

                                    <Button Grid.Column="5"
                                            Text="ðŸ—‘"
                                            FontSize="18"
                                            BackgroundColor="Transparent"
                                            TextColor="#EF5350"
                                            Clicked="OnEliminarClicked"
                                            BindingContext="{Binding}"/>

                                </Grid>
                            </Frame>

                        </DataTemplate>
                    </CollectionView.ItemTemplate>

                </CollectionView>

            </VerticalStackLayout>
        </ScrollView>

    </Grid>

</ContentPage>
